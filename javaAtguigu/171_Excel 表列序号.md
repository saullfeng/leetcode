#### [171. Excel è¡¨åˆ—åºå·](https://leetcode-cn.com/problems/excel-sheet-column-number/)

éš¾åº¦ç®€å•281æ”¶è—åˆ†äº«åˆ‡æ¢ä¸ºè‹±æ–‡æ¥æ”¶åŠ¨æ€åé¦ˆ

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² `columnTitle` ï¼Œè¡¨ç¤º Excel è¡¨æ ¼ä¸­çš„åˆ—åç§°ã€‚è¿”å›è¯¥åˆ—åç§°å¯¹åº”çš„åˆ—åºå·ã€‚

 

ä¾‹å¦‚ï¼Œ

```
    A -> 1
    B -> 2
    C -> 3
    ...
    Z -> 26
    AA -> 27
    AB -> 28 
    ...
```

 

**ç¤ºä¾‹ 1:**

```
è¾“å…¥: columnTitle = "A"
è¾“å‡º: 1
```

**ç¤ºä¾‹ 2:**

```
è¾“å…¥: columnTitle = "AB"
è¾“å‡º: 28
```

**ç¤ºä¾‹ 3:**

```
è¾“å…¥: columnTitle = "ZY"
è¾“å‡º: 701
```

**ç¤ºä¾‹ 4:**

```
è¾“å…¥: columnTitle = "FXSHRXW"
è¾“å‡º: 2147483647
```

 

**æç¤ºï¼š**

- `1 <= columnTitle.length <= 7`
- `columnTitle` ä»…ç”±å¤§å†™è‹±æ–‡ç»„æˆ
- `columnTitle` åœ¨èŒƒå›´ `["A", "FXSHRXW"]` å†…

### è¿›åˆ¶

æ ‡ç­¾ï¼šå­—ç¬¦ä¸²éå†ï¼Œè¿›åˆ¶è½¬æ¢
åˆå§‹åŒ–ç»“æœ ans = 0ï¼Œéå†æ—¶å°†æ¯ä¸ªå­—æ¯ä¸ A åšå‡æ³•ï¼Œå› ä¸º A è¡¨ç¤º 1ï¼Œæ‰€ä»¥å‡æ³•åéœ€è¦æ¯ä¸ªæ•°åŠ  1ï¼Œè®¡ç®—å…¶ä»£è¡¨çš„æ•°å€¼ num = å­—æ¯ - â€˜Aâ€™ + 1
å› ä¸ºæœ‰ 26 ä¸ªå­—æ¯ï¼Œæ‰€ä»¥ç›¸å½“äº 26 è¿›åˆ¶ï¼Œæ¯ 26 ä¸ªæ•°åˆ™å‘å‰è¿›ä¸€ä½
æ‰€ä»¥æ¯éå†ä¸€ä½åˆ™ans = ans * 26 + num
ä»¥ ZY ä¸ºä¾‹ï¼ŒZ çš„å€¼ä¸º 26ï¼ŒY çš„å€¼ä¸º 25ï¼Œåˆ™ç»“æœä¸º 26 * 26 + 25=701

å¦‚æœé¢˜ç›®æ˜¯ 10 è¿›åˆ¶è½¬æ¢ï¼Œé‚£ä¹ˆä½ ä¼šå¾ˆå®¹æ˜“æƒ³åˆ°å¦‚ä¸‹è½¬æ¢è¿‡ç¨‹ï¼šä»é«˜ä½å‘ä½ä½å¤„ç†ï¼Œèµ·å§‹è®© ans ä¸º 0ï¼Œæ¯æ¬¡ä½¿ç”¨å½“å‰ä½æ•°å€¼æ›´æ–° ansansï¼Œæ›´æ–°è§„åˆ™ä¸º ans=ansâˆ—10+val i

 

ä¸¾ä¸ªğŸŒ°ï¼Œå‡è®¾å­˜åœ¨æŸä¸ªåè¿›åˆ¶æ•°å­—ï¼Œç¼–ç ä¸º ABCDABCDï¼ˆå­—æ¯ä¸æ•°å­—çš„æ˜ å°„å…³ç³»ä¸æœ¬é¢˜ç›¸åŒï¼‰ï¼Œè½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š

ansans = 0
ans = ans * 10 + 1ans=ansâˆ—10+1 => A
ans = ans * 10 + 2ans=ansâˆ—10+2 => B
ans = ans * 10 + 3ans=ansâˆ—10+3 => C
ans = ans * 10 + 4ans=ansâˆ—10+4 => D

åŒç†ï¼Œæœ¬é¢˜åªæ˜¯å°† 10 è¿›åˆ¶æ¢æˆ 26è¿›åˆ¶



```java
class Solution {
    public int titleToNumber(String s) {
        char[] cn = s.toCharArray();
        int n =cn.length;
        int ans =0;
        //cn[i]-'A'+1 ç­‰äºcn[i]å­—æ¯æœ¬èº«
        for(int i=0;i<n;i++){
            ans=ans*26+(cn[i]-'A'+1);
        }
        return ans;
        
    }
}
```

![image-20210806103512048](C:\Users\solfeng\AppData\Roaming\Typora\typora-user-images\image-20210806103512048.png)

æ—¶é—´å¤æ‚åº¦ï¼šO(n)
ç©ºé—´å¤æ‚åº¦ï¼šå› ä¸º toCharArray ä¼šåˆ›å»ºä¸ s ç­‰é•¿çš„æ•°ç»„ï¼Œå› æ­¤ä½¿ç”¨ charAt ä»£æ›¿ toCharArray çš„è¯ä¸º O(1)ï¼Œå¦åˆ™ä¸º O(n)



![img](https://pic.leetcode-cn.com/a5e8e39fa19491e3e1d82c6aba3dec24e080c368d0400bf57012548b0fdb2af4-frame_00002.png)

![img](https://pic.leetcode-cn.com/da62003ebc140532fe1e42ff2c46d5c920101d6de50fd3c6910eee1e9d9c7df5-frame_00003.png)